---
import { posts, tags, type Post, type Tag } from '@/content/schema';
import TagLayout from '@/layouts/posts/TagLayout.astro';

interface Props {
  tag: Tag;
  posts: Post[];
}

const props = Astro.props;

export async function getStaticPaths() {
  const filtered = (tag: Tag) => posts.filter((post) => post.tags.includes(tag.name));
  return tags
    .map((tag) => ({ params: { slug: tag.slug }, props: { tag: tag, posts: filtered(tag) } }))
    .filter((page) => page.props.posts.length > 0);
}
---

<TagLayout posts={props.posts} tag={props.tag} pageNum={1} />
