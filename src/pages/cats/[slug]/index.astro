---
import { categories, posts, type Category, type Post } from '@/content/schema';
import CategoryLayout from '@/layouts/posts/CategoryLayout.astro';

interface Props {
  category: Category;
  posts: Post[];
}

const props = Astro.props;

export async function getStaticPaths() {
  const filtered = (cat: Category) => posts.filter((post) => post.category === cat.name);
  return categories
    .map((cat) => ({ params: { slug: cat.slug }, props: { category: cat, posts: filtered(cat) } }))
    .filter((page) => page.props.posts.length > 0);
}
---

<CategoryLayout posts={props.posts} category={props.category} pageNum={1} />
